:host {
  display: flex;
  justify-content: space-between;
  flex-direction: column;
  height: 100%;
  width: 100%;
  max-width: 100%;
  overflow-x: hidden;
  max-height: 500px;
}

.sidebar-parameters {
  padding: var(--padding);
  display: flex;
  flex-direction: column;
  width: 100%;
  max-width: 100%;
  box-sizing: border-box;
  height: 100%;
  overflow-y: auto;
}

// =======================
// MODE LECTURE - ULTRA COMPACT
// =======================

.readonly-compact {
  .essential-info {
    display: flex;
    flex-direction: column;
    gap: var(--padding-small);
  }
  
  .info-row {
    display: flex;
    align-items: center;
    gap: var(--padding-small);
    padding: var(--padding-small);
    background: var(--background-color-lighter);
    border-radius: var(--radius-small);
    font-size: var(--font-size-sm);
    
    .info-icon {
      flex-shrink: 0;
      width: 20px;
      
      i {
        color: var(--primary-color);
        font-size: 0.9rem;
      }
    }
    
    .info-text {
      flex: 1;
      color: var(--font-color);
      font-weight: 500;
      min-width: 0;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    
    .tags-compact {
      display: flex;
      flex-wrap: wrap;
      gap: 0.25rem;
      flex: 1;
    }
    
    .collaborators-compact {
      display: flex;
      gap: 0.25rem;
      flex-wrap: wrap;
      
      .user-avatar-container {
        position: relative;
        display: inline-block;
      }
      
      .micro-avatar-image {
        width: 32px;
        height: 32px;
        border-radius: 50%;
        object-fit: cover;
        border: 2px solid var(--background-color);
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        transition: all var(--transition-duration) ease;
        cursor: pointer;
        
        &:hover {
          transform: scale(1.05);
          box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
          border-color: var(--primary-color);
        }
      }
      
      .fallback-avatar {
        position: absolute;
        top: 0;
        left: 0;
      }
    }
  }
}

// =======================
// MODE ÉDITION - SIDEBAR VERTICAL
// =======================

.edit-sidebar {
  display: flex;
  flex-direction: column;
  gap: var(--gap);
}

.param-section {
  border: 1px solid var(--neutral-color);
  border-radius: var(--radius-small);
  background: var(--background-color-lighter);
  overflow: hidden;
  
  .section-title {
    display: flex;
    align-items: center;
    gap: var(--padding-small);
    padding: var(--padding-small) var(--padding);
    background: var(--container-color);
    border-bottom: 1px solid var(--neutral-color);
    margin: 0;
    font-size: var(--font-size-sm);
    font-weight: 600;
    color: var(--font-color);
    
    i {
      color: var(--primary-color);
      font-size: 0.9rem;
    }
  }
  
  > .p-select,
  > .field-compact,
  > .field-stack,
  > .tags-section,
  > .image-compact,
  > .upload-compact,
  > .version-content {
    padding: var(--padding);
  }
}

// Version content
.version-content {
  display: flex;
  flex-direction: column;
}

// Champs de formulaire
.field-stack {
  display: flex;
  flex-direction: column;
  gap: var(--padding);
  padding: var(--padding) !important;
}

.field-compact {
  display: flex;
  flex-direction: column;
  gap: var(--padding-small);
  
  label {
    font-size: var(--font-size-xs);
    font-weight: 600;
    color: var(--font-color);
    text-transform: uppercase;
    letter-spacing: 0.5px;
  }
}

// =======================
// STYLES SPÉCIFIQUES SIDEBAR
// =======================

// Image compacte
.image-compact {
  display: flex;
  align-items: center;
  gap: var(--padding);
  
  ::ng-deep .sidebar-image {
    border-radius: var(--radius-small);
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  }
  
  ::ng-deep .image-remove {
    width: 28px !important;
    height: 28px !important;
    border-radius: 50% !important;
    background: var(--danger-color) !important;
    border: none !important;
    
    .p-button-icon {
      color: white !important;
      font-size: 0.8rem;
    }
  }
}

// Upload compacte
.upload-compact {
  display: flex;
  justify-content: center;
  
  .upload-progress {
    display: flex;
    align-items: center;
    gap: var(--padding-small);
    justify-content: center;
    
    span {
      color: var(--primary-color);
      font-size: var(--font-size-sm);
    }
  }
}

// Tags
.tags-section {
  display: flex;
  flex-direction: column;
  gap: var(--padding-small);
  
  .tags-list {
    display: flex;
    flex-wrap: wrap;
    gap: 0.25rem;
  }
}

// =======================
// STYLES PRIMENG SIDEBAR
// =======================

::ng-deep {
  // Tags micro pour lecture
  .micro-tag {
    background: var(--primary-color-transparent-50) !important;
    color: var(--primary-color) !important;
    border: 1px solid var(--primary-color) !important;
    font-size: 0.7rem !important;
    padding: 0.2rem 0.4rem !important;
    height: auto !important;
    font-weight: 500;
  }
  
  // Status mini
  .mini-status {
    font-size: 0.7rem !important;
    padding: 0.2rem 0.4rem !important;
    height: auto !important;
    
    .p-tag-icon {
      font-size: 0.7rem !important;
      margin-right: 0.2rem !important;
    }
  }
  
  // Avatar micro
  .micro-avatar {
    background: var(--primary-color) !important;
    color: var(--font-color-invert) !important;
    font-weight: 600;
    width: 20px !important;
    height: 20px !important;
    font-size: 0.6rem !important;
  }
  
  // Tags sidebar
  .sidebar-tag {
    background: var(--primary-color) !important;
    color: var(--font-color-invert) !important;
    font-weight: 500;
    font-size: var(--font-size-xs) !important;
    padding: 0.25rem 0.5rem !important;
    height: auto !important;
    
    .p-chip-remove-icon {
      color: rgba(255, 255, 255, 0.8) !important;
      
      &:hover {
        color: var(--font-color-invert) !important;
      }
    }
  }
  
  // Inputs sidebar
  .sidebar-input,
  .sidebar-textarea {
    font-size: var(--font-size-sm) !important;
    padding: var(--padding-small) !important;
    border-radius: var(--radius-small) !important;
    border: 1px solid var(--neutral-color) !important;
    width: 100% !important;
    
    &:hover {
      border-color: var(--primary-color) !important;
    }
    
    &:focus {
      border-color: var(--primary-color) !important;
      box-shadow: 0 0 0 2px var(--primary-color-transparent-50) !important;
    }
  }
  
  .sidebar-textarea {
    resize: vertical;
    min-height: 60px !important;
  }
  
  // Selects sidebar
  .sidebar-select,
  .sidebar-autocomplete,
  .sidebar-tree {
    .p-dropdown,
    .p-autocomplete,
    .p-treeselect {
      font-size: var(--font-size-sm) !important;
      min-height: 36px !important;
      border-radius: var(--radius-small) !important;
      border: 1px solid var(--neutral-color) !important;
      width: 100% !important;
      
      &:hover {
        border-color: var(--primary-color) !important;
      }
      
      &:focus {
        border-color: var(--primary-color) !important;
        box-shadow: 0 0 0 2px var(--primary-color-transparent-50) !important;
      }
    }
    
    .p-dropdown-label,
    .p-autocomplete-input,
    .p-treeselect-label {
      font-size: var(--font-size-sm) !important;
      padding: var(--padding-small) !important;
    }
  }
  
  // Upload sidebar
  .sidebar-upload .p-button {
    background: var(--primary-color) !important;
    border-color: var(--primary-color) !important;
    border-radius: var(--radius-small) !important;
    padding: var(--padding-small) !important;
    font-size: var(--font-size-sm) !important;
    font-weight: 500;
    width: 100% !important;
    
    &:hover {
      background: var(--primary-color) !important;
      border-color: var(--primary-color) !important;
      opacity: 0.9;
    }
  }
  
  // Footer select
  .select-footer {
    padding: var(--padding-small);
    border-top: 1px solid var(--neutral-color);
    
    .footer-btn {
      width: 100% !important;
      justify-content: center;
      font-size: var(--font-size-xs) !important;
      padding: var(--padding-small) !important;
    }
  }
  
  // Micro spinner
  .micro-spinner {
    width: 16px !important;
    height: 16px !important;
    
    .p-progress-spinner-circle {
      stroke: var(--primary-color) !important;
    }
  }
}

// =======================
// RESPONSIVITÉ MOBILE
// =======================

@media (max-width: 768px) {
  .sidebar-parameters {
    padding: var(--padding-mobile);
  }
  
  .readonly-compact .info-row {
    padding: var(--padding-mobile);
    flex-wrap: wrap;
    
    .info-text {
      white-space: normal;
      word-break: break-word;
    }
  }
  
  .param-section {
    .section-title {
      padding: var(--padding-mobile);
      font-size: var(--font-size-xs);
    }
    
    > .p-select,
    > .field-compact,
    > .field-stack,
    > .tags-section,
    > .image-compact,
    > .upload-compact,
    > .version-content {
      padding: var(--padding-mobile);
    }
  }
  
  .field-stack {
    gap: var(--padding-mobile);
  }
}

// =======================
// ANIMATIONS SUBTILES
// =======================

.param-section {
  transition: all var(--transition-duration) ease;
  
  &:hover {
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.08);
  }
}

.info-row {
  transition: all var(--transition-duration) ease;
  
  &:hover {
    background: var(--background-color) !important;
    transform: translateX(2px);
  }
}

// =======================
// OPTIMISATIONS SCROLL
// =======================

.edit-sidebar {
  scroll-behavior: smooth;
  
  // Améliore les performances de scroll sur les longues listes
  .tags-list,
  .collaborators-compact {
    will-change: transform;
    contain: layout;
  }
}